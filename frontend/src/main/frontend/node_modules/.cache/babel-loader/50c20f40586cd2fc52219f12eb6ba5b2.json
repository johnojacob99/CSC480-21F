{"ast":null,"code":"var _jsxFileName = \"/home/ductran/Desktop/CSC480-21F/frontend/src/main/frontend/src/pages/Student/PeerReviewAssignmentView.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\"; // @mui components\n\nimport Typography from \"@mui/material/Typography\"; //PDF\n\nimport { Document, Page, pdfjs } from \"react-pdf\"; // styled components\n\nimport NavBar from \"../../components/NavBar/NavBar\";\nimport CustomizedButtons from \"../../components/CustomizedButtons\";\nimport bg from \"../../images/multi_background_dashboard.jpg\";\nimport { CardContent, FormControl, Grid, InputLabel, List, MenuItem, Select, Stack, Tab, Tabs } from \"@mui/material\";\nimport CustomizedCard from \"../../components/CustomizedCard\";\nimport CustomizedContainer from \"../../components/CustomizedContainer\";\nimport { Link } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { selectUser } from \"../../features/userSlice\";\nimport Loading from \"../../components/Loading\";\nimport CustomizedPdfUploader from \"../../components/CustomizedPdfUploader\";\nimport CustomizedBody from \"../../components/CustomizedBody\";\nimport CustomizedTextField from \"../../components/CustomizedTextField\";\nimport { handleConvertByteArrayToPdf } from \"../../utils/byteArrayToPDF\";\nimport { Box } from \"@mui/system\";\nimport { getSubmissionsToReviewByStudent, getTeamIdByStudentAndCourse, postNewPeerReviewByStudent, postNewSolutionByStudent } from \"../../axios/APIRequests\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction TabPanel(props) {\n  const {\n    children,\n    value,\n    index,\n    ...other\n  } = props;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    sx: {\n      borderRadius: \"10px\"\n    },\n    role: \"tabpanel\",\n    hidden: value !== index,\n    id: `simple-tabpanel-${index}`,\n    \"aria-labelledby\": `simple-tab-${index}`,\n    ...other,\n    children: value === index && /*#__PURE__*/_jsxDEV(Box, {\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 27\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 5\n  }, this);\n}\n\n_c = TabPanel;\n\nfunction PeerReviewAssignmentView({\n  history,\n  location\n}) {\n  _s();\n\n  const dispatch = useDispatch();\n  const getUser = useSelector(selectUser);\n  const {\n    user,\n    isAuthenticated,\n    authLoading\n  } = getUser;\n  const [scale, setScale] = useState(1.0);\n  const [numPages, setNumPages] = useState(null);\n  const [pageNumber, setPageNumber] = useState(1);\n  const [loading, setLoading] = useState(true);\n  const isFirstPage = pageNumber === 1;\n  const isLastPage = pageNumber === numPages;\n  const [tab, setTab] = useState(0); // ========= main variable =======\n\n  const [score, setScore] = useState();\n  const [teamId, setTeamId] = useState();\n  const [peerReviewInfo, setPeerReviewInfo] = useState();\n  const [submissionPdfFile, setSubmissionPdfFile] = useState();\n  const [submissionPdfFileName, setSubmissionPdfFileName] = useState(\"\");\n  const [submissionArray, setSubmissionArray] = useState([]);\n  const [linkDownload, setLinkDownload] = useState(); //this is peer review instuction pdf\n\n  const [submissionLinkDownload, setSubmissionLinkDownload] = useState(); //this is solution submssion pdf\n\n  var ErrorMessage = \"Please fill out !!!\";\n\n  const handleChange = (event, newValue) => {\n    setTab(newValue);\n  };\n\n  const handleChangeScore = event => {\n    setScore(event.target.value);\n    submissionArray[tab].score = event.target.value;\n  };\n\n  useEffect(() => {\n    if (location.state.assignmentID == undefined) return;\n    var assignmentID = location.state.assignmentID;\n    getSubmissionsToReviewByStudent(assignmentID).then(value => {\n      console.log(value);\n\n      if (value !== undefined) {\n        setPeerReviewInfo(value);\n        let subArray = []; //initialize submission array\n\n        value.teams.map(index => {\n          let sub = {\n            pdfDoc: [],\n            fileName: \"\",\n            score: 0\n          };\n          subArray.push(sub);\n        });\n        setSubmissionArray(subArray);\n        setLoading(false);\n        getTeamIdByStudentAndCourse(value.courseID).then(value => {\n          setTeamId(value.teamID);\n        }).catch(err => {\n          console.log(err);\n        });\n\n        if (value !== undefined) {\n          setLinkDownload(handleConvertByteArrayToPdf(value.peerReviewPdfDoc));\n        }\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n  console.log(submissionArray);\n  useEffect(() => {\n    if (peerReviewInfo !== undefined) {\n      setSubmissionLinkDownload(handleConvertByteArrayToPdf(peerReviewInfo.teams[tab].submission.pdfDoc));\n      setScore(submissionArray[tab].score);\n      setSubmissionPdfFileName(submissionArray[tab].fileName);\n    }\n  }, [tab]);\n  useEffect(() => {\n    console.log(submissionArray);\n    if (submissionArray.length === 0) return;\n    submissionArray[tab].pdfDoc = submissionPdfFile;\n    submissionArray[tab].fileName = submissionPdfFileName;\n  }, [submissionPdfFile]); //======= handle send request to backend =====\n\n  const handleSubmitFile = event => {\n    var newSubArray = [];\n\n    if (submissionPdfFile.length === 0) {\n      alert(ErrorMessage);\n    } else {\n      submissionArray.map((submission, index) => {\n        var newSubmission = {\n          teamID: teamId,\n          assignmentID: peerReviewInfo.assignmentID,\n          pdfDoc: submission.pdfDoc,\n          score: submission.score,\n          submissionID: peerReviewInfo.teams[index].submission.submissionID\n        };\n        newSubArray.push(newSubmission);\n      });\n      const json = JSON.stringify(newSubArray);\n      console.log(newSubArray);\n      postNewPeerReviewByStudent(newSubArray).then(function (response) {\n        console.log(response);\n        history.push(\"/seeallassignment\");\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }; // for submit event\n\n\n  function onDocumentLoadSuccess({\n    numPages\n  }) {\n    setNumPages(numPages);\n  }\n\n  const goToPreviousPage = () => {\n    if (!isFirstPage) setPageNumber(pageNumber - 1);\n  };\n\n  const goToNextPage = () => {\n    if (!isLastPage) setPageNumber(pageNumber + 1);\n  };\n\n  return /*#__PURE__*/_jsxDEV(CustomizedBody, {\n    bg: bg,\n    children: [/*#__PURE__*/_jsxDEV(NavBar, {\n      fixed: true,\n      history: history\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this), loading === true ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(CustomizedContainer, {\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          sx: {\n            marginBottom: \"20px\",\n            display: \"flex\",\n            alignItems: \"center\"\n          },\n          spacing: 9,\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 9,\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              style: {\n                display: \"flex\",\n                textAlign: \"center\",\n                fontWeight: \"600\"\n              },\n              variant: \"h6\",\n              component: \"div\",\n              children: `${peerReviewInfo.title} Peer Review`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(CustomizedCard, {\n            style: {\n              margin: \"20px 0\"\n            },\n            children: /*#__PURE__*/_jsxDEV(CardContent, {\n              children: /*#__PURE__*/_jsxDEV(Stack, {\n                direction: \"row\",\n                spacing: 3,\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                children: [/*#__PURE__*/_jsxDEV(Stack, {\n                  direction: \"row\",\n                  spacing: 1,\n                  children: [/*#__PURE__*/_jsxDEV(Typography, {\n                    style: {\n                      display: \"flex\",\n                      textAlign: \"center\",\n                      fontWeight: \"600\"\n                    },\n                    variant: \"body1\",\n                    component: \"div\",\n                    children: \"Due Date:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 205,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                    style: {\n                      display: \"flex\",\n                      textAlign: \"center\"\n                    },\n                    variant: \"body1\",\n                    component: \"div\",\n                    children: new Date(peerReviewInfo.peerReviewDueDateTime).toLocaleString()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 216,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 204,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(CustomizedButtons, {\n                  type3: true,\n                  model: \"download\",\n                  href: linkDownload,\n                  download: \"PeerReviewInstructor.pdf\",\n                  title: \"download\",\n                  children: \"Download Instructions\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 229,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 15\n          }, this), peerReviewInfo.teams.length !== 0 ? /*#__PURE__*/_jsxDEV(Stack, {\n            direction: \"row\",\n            justifyContent: \"space-between\",\n            style: {\n              flex: \"1\"\n            },\n            children: [peerReviewInfo.teams.map((team, key) => {\n              return /*#__PURE__*/_jsxDEV(TabPanel, {\n                value: tab,\n                index: key,\n                style: {\n                  flex: 1\n                },\n                children: /*#__PURE__*/_jsxDEV(CustomizedCard, {\n                  children: /*#__PURE__*/_jsxDEV(CardContent, {\n                    children: [/*#__PURE__*/_jsxDEV(Stack, {\n                      direction: \"row\",\n                      justifyContent: \"space-between\",\n                      alignItems: \"center\",\n                      children: [/*#__PURE__*/_jsxDEV(Stack, {\n                        direction: \"column\",\n                        spacing: 1,\n                        children: /*#__PURE__*/_jsxDEV(Typography, {\n                          style: {\n                            display: \"flex\",\n                            textAlign: \"center\",\n                            fontWeight: \"600\"\n                          },\n                          variant: \"body1\",\n                          component: \"div\",\n                          children: `Submission ${key + 1}`\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 252,\n                          columnNumber: 33\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 251,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(CustomizedButtons, {\n                        type2: true,\n                        model: \"download\",\n                        href: submissionLinkDownload,\n                        download: \"Solution.pdf\",\n                        children: \"Download Peer Review PDF\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 264,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 249,\n                      columnNumber: 29\n                    }, this), team.submission.pdfDoc && /*#__PURE__*/_jsxDEV(Stack, {\n                      direction: \"row\",\n                      justifyContent: \"center\",\n                      alignItems: \"center\",\n                      p: 1,\n                      height: 825,\n                      children: [/*#__PURE__*/_jsxDEV(CustomizedButtons, {\n                        model: \"arrowL\",\n                        style: {\n                          color: \"black\",\n                          marginBottom: \"10px\"\n                        },\n                        onClick: goToPreviousPage\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 276,\n                        columnNumber: 33\n                      }, this), /*#__PURE__*/_jsxDEV(Document, {\n                        file: {\n                          data: team.submission.pdfDoc\n                        },\n                        onLoadSuccess: onDocumentLoadSuccess,\n                        children: /*#__PURE__*/_jsxDEV(Page, {\n                          pageNumber: pageNumber,\n                          scale: scale\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 285,\n                          columnNumber: 35\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 281,\n                        columnNumber: 33\n                      }, this), /*#__PURE__*/_jsxDEV(CustomizedButtons, {\n                        model: \"arrow\",\n                        style: {\n                          color: \"black\",\n                          marginBottom: \"10px\"\n                        },\n                        onClick: goToNextPage\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 287,\n                        columnNumber: 33\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 274,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n                      direction: \"column\",\n                      spacing: 3,\n                      children: [/*#__PURE__*/_jsxDEV(Typography, {\n                        style: {\n                          display: \"flex\",\n                          textAlign: \"center\",\n                          fontWeight: \"600\"\n                        },\n                        variant: \"body1\",\n                        component: \"div\",\n                        children: \"Score Submission:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 295,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(Stack, {\n                        direction: \"row\",\n                        spacing: 3,\n                        alignItems: \"center\",\n                        children: [/*#__PURE__*/_jsxDEV(FormControl, {\n                          sx: {\n                            width: \"100px\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                            id: \"demo-simple-select-label\",\n                            children: \"Score\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 309,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(Select, {\n                            labelId: \"demo-simple-select-label\",\n                            id: \"demo-simple-select\",\n                            value: score,\n                            label: \"Score\",\n                            onChange: handleChangeScore,\n                            children: Array.from(Array(10).keys()).map((index, key) => /*#__PURE__*/_jsxDEV(MenuItem, {\n                              value: index,\n                              children: index\n                            }, key, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 320,\n                              columnNumber: 39\n                            }, this))\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 312,\n                            columnNumber: 35\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 308,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(CustomizedPdfUploader, {\n                          id: \"submission\",\n                          pdfFileName: submissionPdfFileName,\n                          setPdfFileName: setSubmissionPdfFileName,\n                          setPdfFile: setSubmissionPdfFile\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 324,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 307,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 294,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 248,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 23\n              }, this);\n            }), /*#__PURE__*/_jsxDEV(CustomizedCard, {\n              sx: {\n                display: \"flex\",\n                flexDirection: \"column\",\n                height: \"250px\",\n                marginLeft: \"20px\",\n                justifyContent: \"center\"\n              },\n              children: /*#__PURE__*/_jsxDEV(Tabs, {\n                value: tab,\n                orientation: \"vertical\",\n                onChange: handleChange,\n                variant: \"scrollable\",\n                scrollButtons: true,\n                allowScrollButtonsMobile: true,\n                children: peerReviewInfo.teams.map((team, key) => /*#__PURE__*/_jsxDEV(Tab, {\n                  label: `Submission ${key + 1}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 355,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 346,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(CustomizedCard, {\n            style: {\n              flex: \"1\"\n            },\n            children: /*#__PURE__*/_jsxDEV(CardContent, {\n              children: /*#__PURE__*/_jsxDEV(Stack, {\n                direction: \"row\",\n                justifyContent: \"space-between\",\n                children: \"There is no submission to review\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 13\n        }, this), peerReviewInfo.teams.length !== 0 && /*#__PURE__*/_jsxDEV(Stack, {\n          direction: \"row\",\n          justifyContent: \"flex-end\",\n          alignItems: \"center\",\n          spacing: 2,\n          mt: 3,\n          mr: 20,\n          children: [/*#__PURE__*/_jsxDEV(CustomizedButtons, {\n            type2: true,\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CustomizedButtons, {\n            type1: true,\n            onClick: handleSubmitFile,\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 11\n      }, this)\n    }, void 0, false)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 170,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PeerReviewAssignmentView, \"AIz0HIxJtwwmXV0QN6J7Qb+zPoI=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c2 = PeerReviewAssignmentView;\nexport default PeerReviewAssignmentView;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"TabPanel\");\n$RefreshReg$(_c2, \"PeerReviewAssignmentView\");","map":{"version":3,"sources":["/home/ductran/Desktop/CSC480-21F/frontend/src/main/frontend/src/pages/Student/PeerReviewAssignmentView.js"],"names":["React","useState","useEffect","Typography","Document","Page","pdfjs","NavBar","CustomizedButtons","bg","CardContent","FormControl","Grid","InputLabel","List","MenuItem","Select","Stack","Tab","Tabs","CustomizedCard","CustomizedContainer","Link","useSelector","useDispatch","selectUser","Loading","CustomizedPdfUploader","CustomizedBody","CustomizedTextField","handleConvertByteArrayToPdf","Box","getSubmissionsToReviewByStudent","getTeamIdByStudentAndCourse","postNewPeerReviewByStudent","postNewSolutionByStudent","TabPanel","props","children","value","index","other","borderRadius","PeerReviewAssignmentView","history","location","dispatch","getUser","user","isAuthenticated","authLoading","scale","setScale","numPages","setNumPages","pageNumber","setPageNumber","loading","setLoading","isFirstPage","isLastPage","tab","setTab","score","setScore","teamId","setTeamId","peerReviewInfo","setPeerReviewInfo","submissionPdfFile","setSubmissionPdfFile","submissionPdfFileName","setSubmissionPdfFileName","submissionArray","setSubmissionArray","linkDownload","setLinkDownload","submissionLinkDownload","setSubmissionLinkDownload","ErrorMessage","handleChange","event","newValue","handleChangeScore","target","state","assignmentID","undefined","then","console","log","subArray","teams","map","sub","pdfDoc","fileName","push","courseID","teamID","catch","err","peerReviewPdfDoc","submission","length","handleSubmitFile","newSubArray","alert","newSubmission","submissionID","json","JSON","stringify","response","error","onDocumentLoadSuccess","goToPreviousPage","goToNextPage","marginBottom","display","alignItems","textAlign","fontWeight","title","margin","Date","peerReviewDueDateTime","toLocaleString","flex","team","key","color","data","width","Array","from","keys","flexDirection","height","marginLeft","justifyContent"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\n// @mui components\nimport Typography from \"@mui/material/Typography\";\n//PDF\nimport { Document, Page, pdfjs } from \"react-pdf\";\n\n// styled components\nimport NavBar from \"../../components/NavBar/NavBar\";\nimport CustomizedButtons from \"../../components/CustomizedButtons\";\n\nimport bg from \"../../images/multi_background_dashboard.jpg\";\nimport { CardContent, FormControl, Grid, InputLabel, List, MenuItem, Select, Stack, Tab, Tabs } from \"@mui/material\";\nimport CustomizedCard from \"../../components/CustomizedCard\";\nimport CustomizedContainer from \"../../components/CustomizedContainer\";\nimport { Link } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { selectUser } from \"../../features/userSlice\";\nimport Loading from \"../../components/Loading\";\nimport CustomizedPdfUploader from \"../../components/CustomizedPdfUploader\";\nimport CustomizedBody from \"../../components/CustomizedBody\";\nimport CustomizedTextField from \"../../components/CustomizedTextField\";\nimport { handleConvertByteArrayToPdf } from \"../../utils/byteArrayToPDF\";\nimport { Box } from \"@mui/system\";\nimport { getSubmissionsToReviewByStudent,getTeamIdByStudentAndCourse,postNewPeerReviewByStudent,postNewSolutionByStudent} from \"../../axios/APIRequests\";\n\nfunction TabPanel(props) {\n  const { children, value, index, ...other } = props;\n  return (\n    <div\n      sx={{ borderRadius: \"10px\" }}\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && <Box>{children}</Box>}\n    </div>\n  );\n}\n\nfunction PeerReviewAssignmentView({ history, location }) {\n  const dispatch = useDispatch();\n  const getUser = useSelector(selectUser);\n  const { user, isAuthenticated, authLoading } = getUser;\n\n  const [scale, setScale] = useState(1.0);\n  const [numPages, setNumPages] = useState(null);\n  const [pageNumber, setPageNumber] = useState(1);\n  const [loading, setLoading] = useState(true);\n  const isFirstPage = pageNumber === 1;\n  const isLastPage = pageNumber === numPages;\n  const [tab, setTab] = useState(0);\n  // ========= main variable =======\n  const [score, setScore] = useState();\n  const [teamId, setTeamId] = useState(); \n  const [peerReviewInfo, setPeerReviewInfo] = useState();\n  const [submissionPdfFile, setSubmissionPdfFile] = useState();\n  const [submissionPdfFileName, setSubmissionPdfFileName] = useState(\"\");\n  const [submissionArray, setSubmissionArray] = useState([]);\n  const [linkDownload, setLinkDownload] = useState(); //this is peer review instuction pdf\n  const [submissionLinkDownload, setSubmissionLinkDownload] = useState(); //this is solution submssion pdf\n  var ErrorMessage = \"Please fill out !!!\";\n  const handleChange = (event, newValue) => {\n    setTab(newValue);\n  };\n  const handleChangeScore = (event) => {\n    setScore(event.target.value);\n    submissionArray[tab].score = event.target.value;\n  };\n  useEffect(() => {\n    if (location.state.assignmentID == undefined) return;\n    var assignmentID = location.state.assignmentID;\n    getSubmissionsToReviewByStudent(assignmentID)\n      .then((value) => {\n        console.log(value)\n        if (value !== undefined) {\n          setPeerReviewInfo(value);\n          let subArray = [];\n        //initialize submission array\n        value.teams.map((index) => {\n          let sub = {\n            pdfDoc: [],\n            fileName: \"\",\n            score: 0,\n          };\n          subArray.push(sub);\n        });\n          setSubmissionArray(subArray);\n          setLoading(false);\n          getTeamIdByStudentAndCourse(value.courseID)\n          .then((value) => {\n            setTeamId(value.teamID);\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n          \n          if (value !== undefined) {\n            setLinkDownload(handleConvertByteArrayToPdf(value.peerReviewPdfDoc));\n          }\n        } \n      })\n      .catch((err) => {\n        console.log(err);\n      });\n     \n  }, []);\n\n  console.log(submissionArray)\n  useEffect(() => {\n    if (peerReviewInfo !== undefined) {\n      setSubmissionLinkDownload(\n        handleConvertByteArrayToPdf(peerReviewInfo.teams[tab].submission.pdfDoc)\n      );\n      setScore(submissionArray[tab].score);\n      setSubmissionPdfFileName(submissionArray[tab].fileName)\n    }\n  }, [tab]);\n\n  useEffect(() => {\n    console.log(submissionArray);\n    if (submissionArray.length === 0) return;\n\n    submissionArray[tab].pdfDoc = submissionPdfFile;\n    submissionArray[tab].fileName = submissionPdfFileName\n  }, [submissionPdfFile]);\n  \n  //======= handle send request to backend =====\n  const handleSubmitFile = (event) => {\n    var newSubArray = []\n    if (submissionPdfFile.length === 0) {\n      alert(ErrorMessage);\n    } else {\n      submissionArray.map((submission,index) => {\n        var newSubmission = {\n          teamID: teamId,\n          assignmentID: peerReviewInfo.assignmentID,\n          pdfDoc: submission.pdfDoc,\n          score: submission.score,\n          submissionID: peerReviewInfo.teams[index].submission.submissionID,\n        };\n        newSubArray.push(newSubmission)\n      });\n      const json = JSON.stringify(newSubArray);\n      console.log(newSubArray);\n      postNewPeerReviewByStudent(newSubArray)\n        .then(function (response) {\n          console.log(response);\n           history.push(\"/seeallassignment\");\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n    }\n  };\n\n  // for submit event\n  function onDocumentLoadSuccess({ numPages }) {\n    setNumPages(numPages);\n  }\n  const goToPreviousPage = () => {\n    if (!isFirstPage) setPageNumber(pageNumber - 1);\n  };\n  const goToNextPage = () => {\n    if (!isLastPage) setPageNumber(pageNumber + 1);\n  };\n\n  return (\n    <CustomizedBody bg={bg}>\n      <NavBar fixed history={history}></NavBar>\n      {loading === true ? (\n        <Loading />\n      ) : (\n        <>\n          <CustomizedContainer>\n            <Grid\n              container\n              sx={{\n                marginBottom: \"20px\",\n                display: \"flex\",\n                alignItems: \"center\",\n              }}\n              spacing={9}\n            >\n              <Grid item xs={9}>\n                <Typography\n                  style={{\n                    display: \"flex\",\n                    textAlign: \"center\",\n                    fontWeight: \"600\",\n                  }}\n                  variant=\"h6\"\n                  component=\"div\"\n                >\n                  {`${peerReviewInfo.title} Peer Review`}\n                </Typography>\n              </Grid>\n            </Grid>\n            <div>\n              <CustomizedCard style={{ margin: \"20px 0\"  }}>\n                <CardContent>\n                  <Stack direction=\"row\" spacing={3} justifyContent=\"space-between\" alignItems=\"center\">\n                    <Stack direction=\"row\" spacing={1}>\n                      <Typography\n                        style={{\n                          display: \"flex\",\n                          textAlign: \"center\",\n                          fontWeight: \"600\",\n                        }}\n                        variant=\"body1\"\n                        component=\"div\"\n                      >\n                        Due Date:\n                      </Typography>\n                      <Typography\n                        style={{\n                          display: \"flex\",\n                          textAlign: \"center\",\n                        }}\n                        variant=\"body1\"\n                        component=\"div\"\n                      >\n                        {new Date(\n                          peerReviewInfo.peerReviewDueDateTime\n                        ).toLocaleString()}\n                      </Typography>\n                    </Stack>\n                    <CustomizedButtons\n                      type3\n                      model={\"download\"}\n                      href={linkDownload}\n                      download={\"PeerReviewInstructor.pdf\"}\n                      title=\"download\"\n                    >\n                      Download Instructions\n                    </CustomizedButtons>\n                  </Stack>\n                </CardContent>\n              </CustomizedCard>\n              {peerReviewInfo.teams.length !== 0 ? (\n\n                <Stack direction=\"row\" justifyContent=\"space-between\" style={{flex:\"1\"}}>\n                  {peerReviewInfo.teams.map((team, key) => {\n                    return (\n                      <TabPanel value={tab} index={key} style={{ flex:1}}>\n                        <CustomizedCard >\n                          <CardContent>\n                            <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\"\n                            >\n                              <Stack direction=\"column\" spacing={1}>\n                                <Typography\n                                  style={{\n                                    display: \"flex\",\n                                    textAlign: \"center\",\n                                    fontWeight: \"600\",\n                                  }}\n                                  variant=\"body1\"\n                                  component=\"div\"\n                                >\n                                  {`Submission ${key + 1}`}\n                                </Typography>\n                              </Stack>\n                              <CustomizedButtons\n                                type2\n                                model={\"download\"}\n                                href={submissionLinkDownload}\n                                download={\"Solution.pdf\"}\n                              >\n                                Download Peer Review PDF\n                              </CustomizedButtons>\n                            </Stack>\n                            {team.submission.pdfDoc && (\n                              <Stack direction=\"row\" justifyContent=\"center\" alignItems=\"center\" p={1} height={825}\n                              >\n                                <CustomizedButtons\n                                  model={\"arrowL\"}\n                                  style={{ color: \"black\", marginBottom: \"10px\" }}\n                                  onClick={goToPreviousPage}\n                                ></CustomizedButtons>\n                                <Document\n                                  file={{ data: team.submission.pdfDoc }}\n                                  onLoadSuccess={onDocumentLoadSuccess}\n                                >\n                                  <Page pageNumber={pageNumber} scale={scale} />\n                                </Document>\n                                <CustomizedButtons\n                                  model={\"arrow\"}\n                                  style={{ color: \"black\", marginBottom: \"10px\" }}\n                                  onClick={goToNextPage}\n                                ></CustomizedButtons>\n                              </Stack>\n                            )}\n                            <Stack direction=\"column\" spacing={3}>\n                              <Typography\n                                style={{\n                                  display: \"flex\",\n                                  textAlign: \"center\",\n                                  fontWeight: \"600\",\n                                }}\n                                variant=\"body1\"\n                                component=\"div\"\n                              >\n                                Score Submission:\n                              </Typography>\n\n                              <Stack direction=\"row\" spacing={3} alignItems=\"center\">\n                                <FormControl sx={{width:\"100px\"}}>\n                                  <InputLabel id=\"demo-simple-select-label\">\n                                    Score\n                                  </InputLabel>\n                                  <Select\n                                    labelId=\"demo-simple-select-label\"\n                                    id=\"demo-simple-select\"\n                                    value={score}\n                                    label=\"Score\"\n                                    onChange={handleChangeScore}\n                                  >\n                                    {Array.from(Array(10).keys()).map((index, key)=>(\n                                      <MenuItem value={index} key={key}>{index}</MenuItem>\n                                    ))}\n                                  </Select>\n                                </FormControl>\n                                <CustomizedPdfUploader\n                                  id=\"submission\"\n                                  pdfFileName={submissionPdfFileName}\n                                  setPdfFileName={setSubmissionPdfFileName}\n                                  setPdfFile={setSubmissionPdfFile}\n                                ></CustomizedPdfUploader>\n                              </Stack>\n                            </Stack>\n                          </CardContent>\n                        </CustomizedCard>\n                      </TabPanel>\n                    );\n                  })}\n                  <CustomizedCard\n                    sx={{\n                      display: \"flex\",\n                      flexDirection: \"column\",\n                      height: \"250px\",\n                      marginLeft: \"20px\",\n                      justifyContent: \"center\",\n                    }}\n                  >\n                    <Tabs\n                      value={tab}\n                      orientation=\"vertical\"\n                      onChange={handleChange}\n                      variant=\"scrollable\"\n                      scrollButtons\n                      allowScrollButtonsMobile\n                    >\n                      {peerReviewInfo.teams.map((team, key) => (\n                        <Tab label={`Submission ${key + 1}`} />\n                      ))}\n                    </Tabs>\n                  </CustomizedCard>\n                </Stack>\n              ) : (\n                <CustomizedCard style={{flex:\"1\"}}>\n                  <CardContent>\n                    <Stack direction=\"row\" justifyContent=\"space-between\" >There is no submission to review</Stack>\n                  </CardContent>\n                </CustomizedCard>\n              )}\n            </div>\n            {peerReviewInfo.teams.length !== 0 && (\n              <Stack\n              direction=\"row\"\n              justifyContent=\"flex-end\"\n              alignItems=\"center\"\n              spacing={2}\n              mt={3}\n              mr={20}\n            >\n              <CustomizedButtons type2>Cancel</CustomizedButtons>\n              <CustomizedButtons type1 onClick={handleSubmitFile}>\n                Submit\n              </CustomizedButtons>\n            </Stack>\n            )}\n          </CustomizedContainer>\n        </>\n      )}\n    </CustomizedBody>\n  );\n}\n\nexport default PeerReviewAssignmentView;\n"]},"metadata":{},"sourceType":"module"}